| ç±»å‹                   | Markdown è¯­æ³•               | ç¤ºä¾‹ä¸ç”¨é€”                                                                    |      |    |        |              |
| -------------------- | ------------------------- | ------------------------------------------------------------------------ | ---- | -- | ------ | ------------ |
| **ä¸€çº§æ ‡é¢˜**             | `# æ ‡é¢˜`                    | `# io_uring register buffer æ·±åº¦è§£æ`<br>ğŸ‘‰ ç”¨äºç« èŠ‚æ ‡é¢˜                           |      |    |        |              |
| **äºŒçº§æ ‡é¢˜**             | `## æ ‡é¢˜`                   | `## ä¸€ã€èƒŒæ™¯`<br>ğŸ‘‰ ç”¨äºç« èŠ‚å°èŠ‚æ ‡é¢˜                                                 |      |    |        |              |
| **ä¸‰çº§æ ‡é¢˜**             | `### æ ‡é¢˜`                  | `### 1ï¸âƒ£ è®¾è®¡åŠ¨æœº`<br>ğŸ‘‰ ç”¨äºæ›´ç»†åˆ†å†…å®¹                                             |      |    |        |              |
| **ç²—ä½“**               | `**æ–‡æœ¬**`                  | `**å…³é”®è·¯å¾„ï¼š** fget() + fput()`                                              |      |    |        |              |
| **æ–œä½“**               | `*æ–‡æœ¬*`                    | `*ç”¨æˆ·ç©ºé—´å†…å­˜é¡µ* è¢«å›ºå®šï¼ˆpinnedï¼‰`                                                  |      |    |        |              |
| **åˆ é™¤çº¿**              | `~~æ–‡æœ¬~~`                  | `~~æ—§æœºåˆ¶ï¼ˆaio_readï¼‰~~ å·²å¼ƒç”¨`                                                  |      |    |        |              |
| **é«˜äº®å¼•ç”¨å—**            | `> å¼•ç”¨å†…å®¹`                  | > io_uring æä¾›äº† register buffer æœºåˆ¶ï¼Œé¿å…é‡å¤ GUPã€‚                              |      |    |        |              |
| **å¤šå±‚å¼•ç”¨**             | `>> äºŒçº§å¼•ç”¨`                 | > ä¸€çº§è¯´æ˜<br>> äºŒçº§è¡¥å……è¯´æ˜                                                       |      |    |        |              |
| **ä»£ç è¡Œ**              | `` `code` ``              | `fget(fd)` æˆ– `io_uring_register()`                                       |      |    |        |              |
| **ä»£ç å—**              | <code>`c ... `</code>     | `c<br>struct file *fget(int fd);<br>`                                    |      |    |        |              |
| **å‘½ä»¤è¡Œç¤ºä¾‹**            | <code>`bash ... `</code>  | `bash<br>io_uring_register ring_fd IORING_REGISTER_BUFFERS iovecs 8<br>` |      |    |        |              |
| **è¡¨æ ¼**               | `                         | åˆ—1                                                                       | åˆ—2   | åˆ—3 | `      | ç”¨äºæ€§èƒ½å¯¹æ¯”æˆ–ç‰¹æ€§å¯¹ç…§è¡¨ |
| **ä»»åŠ¡åˆ—è¡¨**             | `- [x] å·²å®Œæˆ` / `- [ ] æœªå®Œæˆ` | - [x] åˆ†æ register file<br>- [ ] åˆ†æ buffer group                          |      |    |        |              |
| **åˆ†å‰²çº¿**              | `---`                     | ç”¨äºç« èŠ‚ä¹‹é—´åˆ†éš”                                                                 |      |    |        |              |
| **è¶…é“¾æ¥**              | `[æ ‡é¢˜](URL)`               | [Linux 5.11 Changelog](https://kernelnewbies.org/Linux_5.11)             |      |    |        |              |
| **å›¾ç‰‡**               | `![æè¿°](è·¯å¾„)`               | `![io_uring æµç¨‹å›¾](./io_uring_flow.png)`                                   |      |    |        |              |
| **ä»£ç å†…æ³¨é‡Š**            | åœ¨ä»£ç å—ä¸­ä½¿ç”¨ `//` æˆ– `/* */`    | `c<br>// æ³¨å†Œç¼“å†²åŒº<br>io_uring_register(...);<br>`                           |      |    |        |              |
| **å†…åµŒåˆ—è¡¨ï¼ˆåµŒå¥—ï¼‰**         | `- ä¸€çº§` + `  - äºŒçº§`         | - ä¼˜åŠ¿ï¼š<br>  - å‡å°‘ç³»ç»Ÿè°ƒç”¨<br>  - æ”¯æŒé›¶æ‹·è´                                         |      |    |        |              |
| **æ•°å­¦å…¬å¼**ï¼ˆéƒ¨åˆ†æ¸²æŸ“å™¨æ”¯æŒï¼‰    | `$å…¬å¼$` æˆ– `$$å…¬å¼$$`         | `$$ T_{io} = T_{syscall} + T_{gup} + T_{dma} $$`                         |      |    |        |              |
| **æç¤º/è­¦å‘Šå—**ï¼ˆéƒ¨åˆ†æ”¯æŒæ‰©å±•è¯­æ³•ï¼‰ | `> âš ï¸ æ³¨æ„ï¼š`                | > âš ï¸ æ³¨æ„ï¼šæ³¨å†Œåä¸è¦ä¿®æ”¹ç¼“å†²åŒºæ˜ å°„ã€‚                                                    |      |    |        |              |
| **ç¼©è¿›å¼ºè°ƒ**             | `>`ï¼ˆå•å±‚ï¼‰+ ç²—ä½“               | > **ç»“è®ºï¼š** register buffer æ˜¯ I/O å†…å­˜ä¼˜åŒ–çš„å…³é”®ç‰¹æ€§ã€‚                               |      |    |        |              |
| **è„šæ³¨**ï¼ˆéƒ¨åˆ†æ”¯æŒï¼‰         | `è¿™æ˜¯å¼•ç”¨[^1]` + `[^1]: è¯¦ç»†è¯´æ˜` | æ–¹ä¾¿æ–‡æ¡£å†…è§£é‡ŠèƒŒæ™¯                                                                |      |    |        |              |
| **å¼•ç”¨ä»£ç æ–‡ä»¶è·¯å¾„**         | ä½¿ç”¨åå¼•å·                     | `fs/io_uring.c` æˆ– `include/uapi/linux/io_uring.h`                        |      |    |        |              |
| **ç‰ˆæœ¬ä¿¡æ¯è¡¨**            | è¡¨æ ¼å½¢å¼                      | `                                                                        | å†…æ ¸ç‰ˆæœ¬ | ç‰¹æ€§ | commit | `            |
| **å—çº§å¼ºè°ƒæ®µè½**           | `> **é‡ç‚¹ï¼š** å†…å®¹`            | > **é‡ç‚¹ï¼š** register buffer é¿å…é‡å¤ GUP                                       |      |    |        |              |
